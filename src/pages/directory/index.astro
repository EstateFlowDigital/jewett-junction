---
import ThemedPage from '../../layouts/themed-page.astro';
import { DirectoryContent } from '../../components/pages/DirectoryContent';
import { initCMS, getEmployees } from '../../lib/webflow-cms';

// Initialize CMS with Cloudflare runtime context
initCMS(Astro.locals);

// Fetch employees from CMS
let employees: any[] = [];
try {
  const result = await getEmployees();
  employees = result.items;
} catch (error) {
  console.error('Error fetching employees:', error);
}
---

<ThemedPage title="Directory | Jewett Junction" theme="dark" currentSection="directory">
  <DirectoryContent client:load theme="dark" employees={employees} />
</ThemedPage>
